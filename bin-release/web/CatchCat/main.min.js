var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),BasicComponent=function(t){function e(e){var i=t.call(this)||this;return e&&(i.adata=e),i.addEventListener(egret.Event.ADDED_TO_STAGE,i._onAddToStage,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.on_remove,i),i.addEventListener(eui.UIEvent.COMPLETE,i.mx_created,i),i}return __extends(e,t),e.prototype._onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this._onAddToStage,this),this.onAddTostage()},e.prototype.onAddTostage=function(){},e.prototype.onRmovestage=function(){},e.prototype.mx_created=function(t){this.removeEventListener(eui.UIEvent.COMPLETE,this.mx_created,this),this.pre_init()},e.prototype.pre_init=function(){},e.prototype.on_remove=function(){this.onRmovestage(),this.removeEventListener(egret.Event.ADDED_TO_STAGE,this._onAddToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.on_remove,this),this.removeEventListener(eui.UIEvent.COMPLETE,this.mx_created,this)},e}(eui.Component);__reflect(BasicComponent.prototype,"BasicComponent");var BasicMediator=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.addEvent=function(){},e.prototype.init=function(){},e.prototype.removeOther=function(){},e.prototype.removeEvent=function(){},e.prototype.onRegister=function(){this.addEvent(),this.init()},e.prototype.onRemove=function(){this.removeEvent(),this.removeOther()},e}(puremvc.Mediator);__reflect(BasicMediator.prototype,"BasicMediator",["puremvc.IMediator","puremvc.INotifier"]);var Widget=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.disponse=function(){},e.prototype.setParent=function(t){return t.addChild(this),this},e.prototype.setPosition=function(t,e){return this.x=t,this.y=e,this},e.prototype.playGroup=function(){},e.prototype.update=function(t){},e}(eui.Component);__reflect(Widget.prototype,"Widget");var mx;!function(t){var e=function(e){function i(t){return e.call(this,i.NAME,t)||this}return __extends(i,e),Object.defineProperty(i.prototype,"view",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),i.prototype.listNotificationInterests=function(){return[t.SIGN_NAME.ENTER_GAME_ROOT]},i.prototype.handleNotification=function(e){switch(e.getName()){case t.SIGN_NAME.ENTER_GAME_ROOT:this.sendNotification(t.ApplicationMediator.APP_VIEW_CHANGE,{viewName:"GameRoot"})}},i.prototype.clickHandler=function(){this.sendNotification(t.SIGN_NAME.ENTER_GAME_ROOT)},i.prototype.addEvent=function(){this.view.button_b.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},i.prototype.removeEvent=function(){this.view.button_b.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},i.NAME="GameStartMediator",i}(BasicMediator);t.GameStartMediator=e,__reflect(e.prototype,"mx.GameStartMediator")}(mx||(mx={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,o){function n(t){e.call(o,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(o))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var mx;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.initElement(),e}return __extends(e,t),e.prototype.initElement=function(){var t=["bg_g","alert_g"];for(var e in t){var i=new eui.Group;i.percentWidth=100,i.touchEnabled=!1,i.height=GameConfig.stageHeight,i.verticalCenter=0,this.addChild(i),this[t[e]]=i}this.addList=[]},e.prototype.enterGame=function(){console.log("enterGame"),this.change_view("GameStart")},e.prototype.add_view=function(t,e){var i=egret.getDefinitionByName("mx."+t);if(i){var o=new i(e);this.alert_g.addChild(o),this.addList.push(o)}},e.prototype.clean_Add=function(){for(var t in this.addList)this.addList[t]&&this.addList[t].parent&&this.addList[t].parent.removeChild(this.addList[t])},e.prototype.cleanNowView=function(){this.nowView&&this.nowView.parent&&this.nowView.parent.removeChild(this.nowView),this.clean_Add()},e.prototype.change_view=function(t,e){this.cleanNowView();var i=egret.getDefinitionByName("mx."+t);if(i){var o=new i(e);this.nowView=o,this.bg_g.addChild(o)}},e}(eui.UILayer);t.AppContainer=e,__reflect(e.prototype,"mx.AppContainer")}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.getInstance=function(){return null==this.instance&&(this.instance=new i),this.instance},i.prototype.initializeController=function(){e.prototype.initializeController.call(this),this.registerCommand(t.SIGN_NAME.APP_FACADE_START_UP,t.StartupCommand)},i.prototype.startUp=function(e){this.sendNotification(t.SIGN_NAME.APP_FACADE_START_UP,e),this.removeCommand(t.SIGN_NAME.APP_FACADE_START_UP)},i}(puremvc.Facade);t.ApplicationFacade=e,__reflect(e.prototype,"mx.ApplicationFacade",["puremvc.IFacade","puremvc.INotifier"])}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(t){return e.call(this,i.NAME,t)||this}return __extends(i,e),i.prototype.listNotificationInterests=function(){return[i.APP_VIEW_CHANGE,i.APP_VIEW_ADD,t.SIGN_NAME.GAME_RESULT_RUN,UIGame.RE_START_GAME]},i.prototype.handleNotification=function(e){var o=e.getBody(),n=this.viewComponent;switch(e.getName()){case i.APP_VIEW_ADD:n.add_view(o.viewName,o);break;case i.APP_VIEW_CHANGE:n.change_view(o.viewName,o);break;case t.SIGN_NAME.GAME_RESULT_RUN:n.add_view(t.GameResult.NAME,o);break;case UIGame.RE_START_GAME:n.clean_Add()}},i.NAME="ApplicationMediator",i.APP_VIEW_CHANGE="ApplicationMediator_view_change",i.APP_VIEW_ADD="ApplicationMediator_view_add",i}(puremvc.Mediator);t.ApplicationMediator=e,__reflect(e.prototype,"mx.ApplicationMediator",["puremvc.IMediator","puremvc.INotifier"])}(mx||(mx={}));var AppMain=function(){function t(){}return t.Start=function(e){null==this._ins&&(this._ins=new t),this._ins.root=e,this._ins.start()},t.prototype.loadOnlyLoadGroup=function(t,e){var i=this;void 0===e&&(e=null),ResUtils.getInstance().loadGroupWithPro(t,function(){null!=e&&e.call(i)},null,this)},t.prototype.start=function(){var t=this;RES.isGroupLoaded("loginui")?this.initApp():this.loadOnlyLoadGroup("loginui",function(){t.initApp()})},t.prototype.initApp=function(){console.log("initApp");var t=new mx.AppContainer;GameConfig.stage.addChild(t),mx.ApplicationFacade.getInstance().startUp(t)},t}();__reflect(AppMain.prototype,"AppMain");var mx;!function(t){t.SIGN_NAME={APP_FACADE_START_UP:"app_facade_start_up",ENTER_GAME_ROOT:"enter_game_root",GAME_START:"GAME_START",GAME_RESULT_RUN:"GAME_RESULT_RUN"}}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.execute=function(e){(new t.StartGameCommand).register()},i}(puremvc.SimpleCommand);t.ControllerPrepCommand=e,__reflect(e.prototype,"mx.ControllerPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.execute=function(e){this.facade.registerProxy(new t.GameModelProxy)},i}(puremvc.SimpleCommand);t.ModelPrepCommand=e,__reflect(e.prototype,"mx.ModelPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.initializeMacroCommand=function(){this.addSubCommand(t.ModelPrepCommand),this.addSubCommand(t.ViewPrepCommand),this.addSubCommand(t.ControllerPrepCommand)},i}(puremvc.MacroCommand);t.StartupCommand=e,__reflect(e.prototype,"mx.StartupCommand")}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.execute=function(e){var i=e.getBody();this.facade.registerMediator(new t.ApplicationMediator(i)),SceneUtil.getInstance().setCurrentRoot(i),i.enterGame()},i}(puremvc.SimpleCommand);t.ViewPrepCommand=e,__reflect(e.prototype,"mx.ViewPrepCommand",["puremvc.ICommand","puremvc.INotifier"])}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.register=function(){this.facade.registerCommand(t.SIGN_NAME.GAME_START,i)},i.prototype.execute=function(t){},i.NAME="StartGameCommand",i}(puremvc.SimpleCommand);t.StartGameCommand=e,__reflect(e.prototype,"mx.StartGameCommand",["puremvc.ICommand","puremvc.INotifier"])}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(t){var o=e.call(this,t)||this;return o.skinName=i.NAME+"Skin",o}return __extends(i,e),i.prototype.onAddTostage=function(){console.log("GameStart>>>onAddTostage");var e=t.ApplicationFacade.getInstance(),i=new t.GameResultMediator(this);e.registerMediator(i),i.setResultData(this.adata),this.x=.5*(GameConfig.stageWidth-this.width),this.y=.5*(GameConfig.stageHeight-this.height)},i.prototype.onRmovestage=function(){var e=t.ApplicationFacade.getInstance();e.removeMediator(t.GameResultMediator.NAME)},i.NAME="GameResult",i}(BasicComponent);t.GameResult=e,__reflect(e.prototype,"mx.GameResult")}(mx||(mx={}));var mx;!function(t){var e=function(t){function e(i){return t.call(this,e.NAME,i)||this}return __extends(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e.prototype.listNotificationInterests=function(){return[]},e.prototype.reStarGame=function(t){console.log("reStarGame"),this.sendNotification(UIGame.RE_START_GAME)},e.prototype.setResultData=function(t){this.mData=t,this.updataView()},e.prototype.updataView=function(){null!=this.mData&&(this.view.scoreLabel.text=this.mData.score+"",this.mData.state?this.view.currentState="win":this.view.currentState="lose"),this.view.heightScoreLabel.text="0";var t=egret.localStorage.getItem("WinStep");if(t){var e=parseInt(t);0!=e&&0/0!=e&&(this.view.heightScoreLabel.text=100-e+"")}this.addEvent()},e.prototype.addEvent=function(){this.view.againImage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reStarGame,this),this.view.againImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reStarGame,this)},e.prototype.removeEvent=function(){this.view.againImage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reStarGame,this)},e.NAME="GameResultMediator",e}(BasicMediator);t.GameResultMediator=e,__reflect(e.prototype,"mx.GameResultMediator")}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.UIList=new Object,t.skinName=i.NAME+"Skin",t}return __extends(i,e),i.prototype.onAddTostage=function(){console.log("GameRoot>>>onAddTostage"),this.wait.visible=!1,this.initRoot();var e=t.ApplicationFacade.getInstance();e.registerMediator(new t.GameRootMediator(this))},i.prototype.initRoot=function(){this.wayLayer=new egret.DisplayObjectContainer,this.catLayer=new egret.DisplayObjectContainer,this.addChild(this.wayLayer),this.addChild(this.catLayer),this.addChild(this.wait),this.initCat()},i.prototype.initCat=function(){this.CatList=[],this.cat=new Cat(0),this.cat1=new Cat(1),this.CatList.push(this.cat),this.CatList.push(this.cat1)},i.prototype.updataPoint=function(t){var e;if(this.UIList.hasOwnProperty(t.index+""))e=this.UIList[t.index];else{e=new UIWayPoint;var i=t.j%2==0?22:0;e.x=45*t.i+this.pointList.x+i,e.y=45*t.j+this.pointList.y,this.UIList[t.index]=e,this.wayLayer.addChild(e)}e.upData(t)},i.prototype.catLose=function(t){var e=this.getCurrCat(t);e.toWeiZhu()},i.prototype.getCurrCat=function(t){return this.CatList[t]},i.prototype.UpdataCatBir=function(t){var e=t.j%2==0?22:0,i=this.getCurrCat(t.catIndex);i.x=45*t.i+this.pointList.x+e,i.y=45*t.j+this.pointList.y,this.catLayer.addChild(i);var o=i.y;i.y=0;var n=egret.Tween.get(i);n.to({y:o},1e3)},i.prototype.UpdataCat=function(t){var e=t.j%2==0?22:0,i=this.getCurrCat(t.catIndex);i.x=45*t.i+this.pointList.x+e,i.y=45*t.j+this.pointList.y,this.catLayer.addChild(i)},i.prototype.onRmovestage=function(){var e=t.ApplicationFacade.getInstance();e.removeMediator(t.GameRootMediator.NAME)},i.NAME="GameRoot",i}(BasicComponent);t.GameRoot=e,__reflect(e.prototype,"mx.GameRoot")}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(t){return e.call(this,i.NAME,t)||this}return __extends(i,e),Object.defineProperty(i.prototype,"view",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),i.prototype.listNotificationInterests=function(){return[UIGame.UPDATA,UIGame.UPDATA_CAT,UIGame.UPDATA_CAT_Bir,UIGame.GAME_Cat_Lose,UIGame.GAME_Win,UIGame.GAME_Lose,UIGame.RE_START_GAME]},i.prototype.handleNotification=function(t){var e=t.getBody();switch(t.getName()){case UIGame.RE_START_GAME:this.reStarGame();break;case UIGame.UPDATA:this.UpdataData(e);break;case UIGame.UPDATA_CAT:this.UpdataCat(e);break;case UIGame.UPDATA_CAT_Bir:this.UpdataCatBir(e);break;case UIGame.GAME_Cat_Lose:this.catLose(e);break;case UIGame.GAME_Win:this.showWin(e);break;case UIGame.GAME_Lose:this.showLose(e)}},i.prototype.catLose=function(t){this.view.catLose(t.data)},i.prototype.showWait=function(){this.view.wait.visible=!0},i.prototype.hideWait=function(){this.view.wait.visible=!1},i.prototype.showWin=function(e){this.showWait();var i=e.data;this.sendNotification(t.SIGN_NAME.GAME_RESULT_RUN,i)},i.prototype.showLose=function(e){this.showWait();var i=e.data;this.sendNotification(t.SIGN_NAME.GAME_RESULT_RUN,i)},i.prototype.init=function(){this.initGame();var e=this.facade.retrieveProxy(t.GameModelProxy.NAME);e.updataCat()},i.prototype.clickHandler=function(){},i.prototype.addEvent=function(){this.view.restart_b.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reStarGame,this)},i.prototype.reStarGame=function(e){void 0===e&&(e=null);var i=this.facade.retrieveProxy(t.GameModelProxy.NAME);i.reSetData(),this.initGame(),i.updataCat()},i.prototype.UpdataCat=function(t){var e=t.data;this.view.UpdataCat(e)},i.prototype.UpdataCatBir=function(t){var e=t.data;this.view.UpdataCatBir(e)},i.prototype.initGame=function(e){void 0===e&&(e=null),this.hideWait();var i,o=this.facade.retrieveProxy(t.GameModelProxy.NAME),n=o.reSetData(),a=o.pointMax;this.view.score_t.text=o.nowStep+"";for(var r=0;a>r;r++)i=n.get(r),this.view.updataPoint(i);this.view.cat.reStart(),this.view.cat1.reStart()},i.prototype.UpdataData=function(e){var i=this.facade.retrieveProxy(t.GameModelProxy.NAME);this.view.score_t.text=i.nowStep+"";var o=e.data;this.view.updataPoint(o)},i.prototype.removeEvent=function(){},i.prototype.removeOther=function(){},i.NAME="GameRootMediator",i}(BasicMediator);t.GameRootMediator=e,__reflect(e.prototype,"mx.GameRootMediator")}(mx||(mx={}));var mx;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.skinName=i.NAME+"Skin",t}return __extends(i,e),i.prototype.onAddTostage=function(){console.log("GameStart>>>onAddTostage");var e=t.ApplicationFacade.getInstance();e.registerMediator(new t.GameStartMediator(this))},i.prototype.onRmovestage=function(){var e=t.ApplicationFacade.getInstance();e.removeMediator(t.GameStartMediator.NAME)},i.NAME="GameStart",i}(BasicComponent);t.GameStart=e,__reflect(e.prototype,"mx.GameStart")}(mx||(mx={}));var GameConfig=function(){function t(){}return t.stageWidth=640,t.stageHeight=1136,t}();__reflect(GameConfig.prototype,"GameConfig");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function o(o){e.call(i,o,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?o(n):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var mx;!function(t){var e=function(e){function i(){var t=e.call(this,i.NAME)||this;return t.endPoints=[],t.pointMax=0,t.nowStep=0,t.lastIndex=-1,t.minHasNum=7,t.maxHasNum=11,t.star=new AStar,t.initData(),t}return __extends(i,e),i.prototype.initData=function(){this.pointData=new CustomMap,this.pointMax=0;for(var t=GameModel.h;t>0;t--)for(var e=GameModel.w;e>0;e--){var i=WayPointData.creatData(this.pointMax,t,e);this.pointData.add(this.pointMax,i),this.pointData.add(t+"_"+e,i),(1==t||9==e||9==t||1==e)&&this.endPoints.push(i),this.pointMax++}this.initCatData(),this.addEvent()},i.prototype.initCatData=function(){this.CatWayData=WayPointData.creatData(40,5,5),this.CatWayData.catIndex=0,this.CatWay1Data=WayPointData.creatData(31,6,5),this.CatWay1Data.catIndex=1},i.prototype.addEvent=function(){GlobalDispatcher.Ins.addEventListener(UIWayPoint.POINT_CLICK,this.UpdataData,this)},i.prototype.UpdataData=function(e){this.nowStep=this.nowStep+1;var i=e.data;i.clickState(),this.pointData.update(this.pointMax,i),this.pointData.update(i.i+"_"+i.j,i);var o=t.ApplicationFacade.getInstance();o.sendNotification(UIGame.UPDATA,new CommonEvent(UIGame.UPDATA,i));var n=this.star.initPath(this);if(null==n){if(n=this.star.CanMove(this),null==n){var a=ResultData.creatData(!0,this.nowStep);if(-1!=this.lastIndex){var o=t.ApplicationFacade.getInstance();o.sendNotification(UIGame.GAME_Win,new CommonEvent(UIGame.GAME_Win,a))}else-1==this.lastIndex;if(this.lastIndex=this.nowStep+1,n=this.star.CanMove(this),null==n&&(a=ResultData.creatData(!0,this.nowStep),-1!=this.lastIndex)){var o=t.ApplicationFacade.getInstance();o.sendNotification(UIGame.GAME_Win,new CommonEvent(UIGame.GAME_Win,a))}return}var o=t.ApplicationFacade.getInstance();o.sendNotification(UIGame.GAME_Cat_Lose,new CommonEvent(UIGame.GAME_Cat_Lose,this.currCatIndex))}var r;0==this.currCatIndex?(this.catPoint=WayPointData.creatData(40,n[1],n[2]),r=this.catPoint):(this.catPoint1=WayPointData.creatData(40,n[1],n[2]),r=this.catPoint1),r.catIndex=this.currCatIndex,console.log("this.currCatIndex:"+r.catIndex),console.log("this.i:"+r.i),console.log("this.j:"+r.j);var o=t.ApplicationFacade.getInstance();if(o.sendNotification(UIGame.UPDATA_CAT,new CommonEvent(UIGame.UPDATA_CAT,r)),9==n[2]||1==n[1]||9==n[1]||1==n[2]){var s=ResultData.creatData(!1,this.nowStep),o=t.ApplicationFacade.getInstance();o.sendNotification(UIGame.GAME_Lose,new CommonEvent(UIGame.GAME_Lose,s))}},Object.defineProperty(i.prototype,"currCatIndex",{get:function(){return this.lastIndex>0?this.lastIndex%2:this.nowStep%2},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currCatPoint",{get:function(){return 0==this.currCatIndex?this.catPoint:this.catPoint1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"otherCatPoint",{get:function(){return 0==this.currCatIndex?this.catPoint1:this.catPoint},enumerable:!0,configurable:!0}),i.prototype.reSetData=function(){this.nowStep=0,this.lastIndex=-1,this.catPoint=null,this.catPoint1=null,this.pointMax=0;for(var t=GameModel.h;t>0;t--)for(var e=GameModel.w;e>0;e--){var i=WayPointData.creatData(this.pointMax,t,e);this.pointData.update(this.pointMax,i),this.pointData.update(i.i+"_"+i.j,i),this.pointMax++}for(var o=this.minHasNum+Math.ceil(Math.random()*(this.maxHasNum-this.minHasNum)),n=[],o=30;o>0;){var a=Math.ceil(Math.random()*this.pointMax);-1==n.indexOf(a)&&81!=a&&40!=a&&31!=a&&(n.push(a),o--)}var r=n.length;console.log("障碍物体  数量： "+r);for(var s=0;r>s;s++){var i=this.pointData.get(n[s]);i.clickState()}return this.pointData},i.prototype.updataCat=function(){if(null==this.catPoint){this.catPoint=this.CatWayData.copy(),this.catPoint1=this.CatWay1Data.copy();var e=t.ApplicationFacade.getInstance();e.sendNotification(UIGame.UPDATA_CAT_Bir,new CommonEvent(UIGame.UPDATA_CAT_Bir,this.catPoint)),e.sendNotification(UIGame.UPDATA_CAT_Bir,new CommonEvent(UIGame.UPDATA_CAT_Bir,this.catPoint1))}},i.prototype.getNode=function(t,e){return this.pointData.get(t+"_"+e)},i.NAME="GameModelProxy",i.h=9,i.w=9,i}(puremvc.Proxy);t.GameModelProxy=e,__reflect(e.prototype,"mx.GameModelProxy",["puremvc.IProxy","puremvc.INotifier"])}(mx||(mx={}));var SceneUtil=function(){function t(){this.showUIList=[]}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.setCurrentRoot=function(t){this._root=t},t.prototype.getCurrentUi=function(){return this._currentUi},t.prototype.goGame=function(){this.showUi(new UIGame)},t.prototype.goLoginUi=function(){var t=this;RES.isGroupLoaded("loginui")?this.showUi(new UILogin):this.loadOnlyLoadGroup("loginui",function(){t.showUi(new UILogin)})},t.prototype.showUIResult=function(t){var e=new UIResult;this.addUi(e),e.setResultData(t),e.playGroup()},t.prototype.addUi=function(t,e){void 0===e&&(e=null),this.showUIList.push(t),e||(e=this._root),e.addChild(t)},t.prototype.removeUi=function(t){var e=this.showUIList.indexOf(t);this.showUIList.splice(e,1),null!=t.parent&&t.parent.removeChild(t),t.disponse()},t.prototype.removeCurrUi=function(){null!=this._currentUi&&(this._currentUi.parent.removeChild(this._currentUi),this._currentUi.disponse())},t.prototype.showUi=function(t){this.removeCurrUi(),this._currentUi=t,this._root.addChild(this._currentUi)},t.prototype.loadOnlyLoadGroup=function(t,e){var i=this;void 0===e&&(e=null),ResUtils.getInstance().loadGroupWithPro(t,function(){null!=e&&e.call(i)},null,this)},t._instance=null,t}();__reflect(SceneUtil.prototype,"SceneUtil");var PointStateEnum;!function(t){t[t.empety=0]="empety",t[t.has=1]="has"}(PointStateEnum||(PointStateEnum={}));var CommonEvent=function(t){function e(e,i,o,n){void 0===i&&(i=null),void 0===o&&(o=!1),void 0===n&&(n=!1);var a=t.call(this,e,o,n)||this;return a._data=i,a}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}(egret.Event);__reflect(CommonEvent.prototype,"CommonEvent");var GlobalDispatcher=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"Ins",{get:function(){return null==this._ins&&(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e}(egret.EventDispatcher);__reflect(GlobalDispatcher.prototype,"GlobalDispatcher");var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isResConfigLoadEnd=!1,e.isThemeLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},GameConfig.stageWidth=this.stage.stageWidth,GameConfig.stageHeight=this.stage.stageHeight,this.root=new egret.DisplayObjectContainer,this.addChild(this.root),GameConfig.stage=this.stage;var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json?v=20180108","resource/");var i=new eui.Theme("resource/default.thm.json?v=20180108",this.stage);i.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),this.isResConfigLoadEnd=!0,this.startLoadPreLoad()},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.startLoadPreLoad()},e.prototype.startLoadPreLoad=function(){this.isThemeLoadEnd&&this.isResConfigLoadEnd&&AppMain.Start(this.root)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var Cat=function(t){function e(e){var i=t.call(this)||this;return i.mIndex=0,i.initData(),i.mIndex=e,i}return __extends(e,t),e.prototype.initData=function(){this.stay=MovieClipAciton.creat("stay"),this.weizhu=MovieClipAciton.creat("weizhu"),this.stand=MovieClipAciton.creat("stand"),this.defAciton()},e.prototype.defAciton=function(){this.toStay()},e.prototype.reStart=function(){this.toStay()},e.prototype.toStay=function(){this.removeCurrAciton(),this.showMC=this.stay.getMovieClip(),this.addChild(this.showMC),this.showMC.play(-1),console.log(this.showMC.width),console.log(this.showMC.height),this.showMC.x=-10,this.showMC.y=.5*-this.showMC.height-10},e.prototype.toWeiZhu=function(){this.removeCurrAciton(),this.showMC=this.weizhu.getMovieClip(),this.addChild(this.showMC),this.showMC.play(-1),this.showMC.x=-10,this.showMC.y=.5*-this.showMC.height-10},e.prototype.removeCurrAciton=function(){null!=this.showMC&&this.showMC.parent&&this.showMC.parent.removeChild(this.showMC),this.showMC=null},e.prototype.initFactory=function(t,e){var i=RES.getRes(e+"_json"),o=RES.getRes(e+"_png");t=new egret.MovieClipDataFactory(i,o)},e}(egret.DisplayObjectContainer);__reflect(Cat.prototype,"Cat");var MovieClipAciton=function(){function t(){}return t.creat=function(e){var i=new t,o=RES.getRes(e+"_json"),n=RES.getRes(e+"_png");return i.name=e,i.factory=new egret.MovieClipDataFactory(o,n),i},t.prototype.getMovieClip=function(){return null==this.MovieClip&&(this.MovieClip=new egret.MovieClip(this.factory.generateMovieClipData(name))),this.MovieClip},t}();__reflect(MovieClipAciton.prototype,"MovieClipAciton");var GameModel=function(){function t(){}return t.h=9,t.w=9,t}();__reflect(GameModel.prototype,"GameModel");var UIGame=function(t){function e(){var e=t.call(this)||this;return e.UIList=new Object,e.skinName="UIGame_eui",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.wayLayer=new egret.DisplayObjectContainer,this.catLayer=new egret.DisplayObjectContainer,this.initCat(),this.addChild(this.wayLayer),this.addChild(this.catLayer),this.addEvent(),this.initGame()},e.prototype.initCat=function(){this.CatList=[],this.cat=new Cat(0),this.cat1=new Cat(1),this.CatList.push(this.cat),this.CatList.push(this.cat1)},e.prototype.addEvent=function(){this.reStartImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reStarGame,this)},e.prototype.removeEvent=function(){this.reStartImage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reStarGame,this)},e.prototype.catLose=function(t){var e=this.getCurrCat(t.data);e.toWeiZhu()},e.prototype.showWin=function(t){this.removeEvent();var e=t.data;SceneUtil.getInstance().showUIResult(e)},e.prototype.showLose=function(t){this.removeEvent();var e=t.data;SceneUtil.getInstance().showUIResult(e)},e.prototype.reStarGame=function(t){this.removeEvent(),this.addEvent(),this.initGame()},e.prototype.UpdataCat=function(t){var e=t.data,i=e.j%2==0?22:0,o=this.getCurrCat(e.catIndex);o.x=45*e.i+this.pointList.x+i,o.y=45*e.j+this.pointList.y,this.catLayer.addChild(o)},e.prototype.getCurrCat=function(t){return this.CatList[t]},e.prototype.UpdataCatBir=function(t){var e=t.data,i=e.j%2==0?22:0,o=this.getCurrCat(e.catIndex);o.x=45*e.i+this.pointList.x+i,o.y=45*e.j+this.pointList.y,this.catLayer.addChild(o),this.removeEvent();var n=o.y;o.y=0;var a=egret.Tween.get(o).call(this.onComplete,this);a.to({y:n},1e3)},e.prototype.onComplete=function(){this.addEvent()},e.prototype.initGame=function(t){void 0===t&&(t=null);this.cat.reStart(),this.cat1.reStart()},e.prototype.updataPoint=function(t){var e;if(this.UIList.hasOwnProperty(t.index+""))e=this.UIList[t.index];else{e=new UIWayPoint;var i=t.j%2==0?22:0;e.x=45*t.i+this.pointList.x+i,e.y=45*t.j+this.pointList.y,this.UIList[t.index]=e,this.wayLayer.addChild(e)}e.upData(t)},e.prototype.UpdataData=function(t){var e=t.data;this.updataPoint(e)},e.RE_START_GAME="RE_START_GAME",e.UPDATA="UIGame_updata",e.UPDATA_CAT="UIGame_updata_cat",e.UPDATA_CAT_Bir="UIGame_updata_cat_Bir",e.RE_GAME="UIGame_re_game",e.GAME_Win="UIGame_GAME_Win",e.GAME_Lose="UIGame_GAME_Lose",e.GAME_Cat_Lose="UIGame_GAME_Cat_Lose",e}(Widget);__reflect(UIGame.prototype,"UIGame");var UIWayPoint=function(t){function e(){var e=t.call(this)||this;return e.skinName="UIWayPoint_eui",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pointClick,this)},e.prototype.pointClick=function(t){GlobalDispatcher.Ins.dispatchEvent(new CommonEvent(e.POINT_CLICK,this.thisData))},e.prototype.upData=function(t){this.thisData=t,this.currentState=t.state},e.POINT_CLICK="UIWayPoint_POINT_CLICK",e}(Widget);__reflect(UIWayPoint.prototype,"UIWayPoint");var WayPointData=function(){function t(){this._state=PointStateEnum.empety,this.index=-1,this.i=-1,this.j=-1,this.catIndex=-1}return t.creatData=function(e,i,o){var n=new t;return n.index=e,n.i=i,n.j=o,n},Object.defineProperty(t.prototype,"state",{get:function(){return this._state==PointStateEnum.empety?"empty":this._state==PointStateEnum.has?"has":"empty"},enumerable:!0,configurable:!0}),t.prototype.clickState=function(){this._state=PointStateEnum.has},t.prototype.restState=function(){this._state=PointStateEnum.empety},Object.defineProperty(t.prototype,"walkable",{get:function(){return this._state==PointStateEnum.empety?!0:this._state==PointStateEnum.has?!1:!0},enumerable:!0,configurable:!0}),t.prototype.copy=function(){var e=t.creatData(this.index,this.i,this.j);return e.catIndex=this.catIndex,e},t.prototype.getDistanceTo=function(t){var e=t.i-this.i,i=t.j-this.j;return this.distance=Math.sqrt(e*e+i*i),this.distance},t}();__reflect(WayPointData.prototype,"WayPointData");var UILogin=function(t){function e(){var e=t.call(this)||this;return e.skinName="UILogin_eui",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.GameStart,this)},e.prototype.GameStart=function(t){SceneUtil.getInstance().goGame()},e.prototype.disponse=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.GameStart,this)},e}(Widget);__reflect(UILogin.prototype,"UILogin");var ResultData=function(){function t(){this._state=!1,this._step=0}return t.creatData=function(e,i){var o=new t;if(o._state=e,e&&!egret.localStorage.getItem("WinStep"))egret.localStorage.setItem("WinStep",i+"");else if(e){var n=parseInt(egret.localStorage.getItem("WinStep"));n>i&&egret.localStorage.setItem("WinStep",i+"")}return o._step=i,o},Object.defineProperty(t.prototype,"score",{get:function(){return this._state?100-this._step:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),t}();__reflect(ResultData.prototype,"ResultData");var UIResult=function(t){function e(){var e=t.call(this)||this;return e.skinName="UIResult_eui",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.reStarGame=function(t){SceneUtil.getInstance().goGame()},e.prototype.setResultData=function(t){this.mData=t},e.prototype.playGroup=function(){this.againImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reStarGame,this),null!=this.mData&&(this.scoreLabel.text=this.mData.score+"",this.mData.state?this.currentState="win":this.currentState="lose"),this.heightScoreLabel.text="0";var t=egret.localStorage.getItem("WinStep");if(t){var e=parseInt(t);0!=e&&0/0!=e&&(this.heightScoreLabel.text=100-e+"")}},e.prototype.disponse=function(){this.againImage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reStarGame,this)
},e}(Widget);__reflect(UIResult.prototype,"UIResult");var AStar=function(){function t(){this.isEnd=!1,this._straightCost=1,this._diagCost=Math.SQRT2,this.loopArr=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,0]],this.loopArr2=[[1,-1],[1,0],[1,1],[0,-1],[0,1],[-1,0]],this.Paths=[]}return t.prototype.initPath=function(t){this._grid=t,this._open=[],this._closed=[],this._startNode=this._grid.currCatPoint,this._endNodes=this._grid.endPoints,this._otherNode=this._grid.otherCatPoint,this._endNode=this._grid.endPoint,this._startNode.g=0,this._startNode.f=this._startNode.g;var e=this._endNodes.length;this.Paths=[];for(var i=0;e>i;i++)this._open=[],this._open[0]=this._startNode,this._closed=[],this.isEnd=!1,this._endNode=this._grid.endPoints[i],this.search();return this.Paths.sort(function(t,e){return t[0]>e[0]?1:-1}),1==this.Paths.length?null:this.Paths[0]},t.prototype.CanMove=function(t){this._grid=t,this._open=[],this._closed=[],this._startNode=this._grid.currCatPoint,this._otherNode=this._grid.otherCatPoint,this._endNodes=this._grid.endPoints,this._endNode=this._grid.endPoint,this._startNode.g=0,this._startNode.f=this._startNode.g;var e=[];this._startNode=this._grid.currCatPoint;var i,o;this._startNode.j%2>0?(i=this.loopArr.length,o=this.loopArr):(i=this.loopArr2.length,o=this.loopArr2);for(var n=0;i>n;n++){var a=o[n],r=this._startNode.i+a[0],s=this._startNode.j+a[1],h=this._grid.getNode(r,s);h&&(h.i==this._startNode.i&&h.j==this._startNode.j||!h.walkable||h.i==this._otherNode.i&&h.j==this._otherNode.j||e.push([1,h.i,h.j]))}return e[0]},t.prototype.search=function(){for(var t;!this.isEnd;){var e,i=this._open.length;for(t=this._open[0],e=0,a=0;i>a;a++)this._open[a].f<t.f&&(t=this._open[a],e=a);this._open[e]=this._open[this._open.length-1],this._open.pop(),this._closed.push(t);var o,n;t.j%2>0?(o=this.loopArr.length,n=this.loopArr):(o=this.loopArr2.length,n=this.loopArr2);for(var a=0;o>a;a++){var r=n[a],s=t.i+r[0],h=t.j+r[1],c=this._grid.getNode(s,h);if(c&&!(c.i==t.i&&c.j==t.j||!c.walkable||c.i==this._otherNode.i&&c.j==this._otherNode.j)){var p=this._straightCost,u=t.g+p,d=u;-1!=this._open.indexOf(c)||-1!=this._closed.indexOf(c)?d<c.f&&(c.f=d,c.g=u,c.parent=t):(c.f=d,c.g=u,c.parent=t,this._open.push(c)),c.i==this._endNode.i&&c.j==this._endNode.j&&(this._endNode=c,this.isEnd=!0)}}if(0==this._open.length)return console.log("no path found"),this.isEnd=!0,!1}return this.buildPath(),!0},t.prototype.buildPath=function(){var t=[],e=this._endNode;for(t.push(e);e!=this._startNode;)e=e.parent,t.unshift(e);this.Paths.push([t.length,t[1].i,t[1].j])},Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"floydPath",{get:function(){return this._floydPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visited",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}();__reflect(AStar.prototype,"AStar");var CustomMap=function(){function t(){this._record=new Object,this._length=0}return t.prototype.add=function(e,i,o,n){void 0===n&&(n=!1);var a=!1,r=UIDManager.getUid(e,o);if(null==this._record[r])this._record[r]=i,this._length++,a=!0;else if(n){var s=this._record[r];s!=i&&(s.constructor==t&&s.gc(),this._record[r]=i),a=!0}return a},t.prototype.update=function(t,e,i){var o=UIDManager.getUid(t,i);null!=this._record[o]&&(this._record[o]=e)},t.prototype.get=function(t,e){var i=UIDManager.getUid(t,e);return this._record[i]},t.prototype.del=function(t,e){var i=UIDManager.getUid(t,e),o=this._record[i];return delete this._record[i],null!=o&&this._length--,o},t.prototype.gc=function(){this.clear()},t.prototype.clear=function(){var e,i;for(e in this._record)i=this._record[e],delete this._record[e],i.constructor==t&&i.gc();this._length=0},t.prototype.forEach=function(t,e){var i,o;for(i in this._record)if(o=this._record[i],!t.apply(e,[o]))return},t.prototype["for"]=function(t,e){var i;for(i in this._record)if(!t.apply(e,[i]))return},Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),t}();__reflect(CustomMap.prototype,"CustomMap");var UIDManager=function(){function t(){}return t.getUid=function(e,i){if(null!=e)return e.constructor==String||e.constructor==Number?e:(null==e["com.once.uid"]&&(t._uid++,e["com.once.uid"]="com.once.uid"+t._uid),null!=i?(null==i["com.once.uid"]&&(t._uid++,i["com.once.uid"]="com.once.uid"+t._uid),i["com.once.uid"]+"_"+e["com.once.uid"]):e["com.once.uid"]);throw new Error("uid生成失败")},t._uid=0,t}();__reflect(UIDManager.prototype,"UIDManager");var ResJsonUtils=function(){function t(){this._configs=new Array}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.addConfig=function(t,e){this._configs.push([t,e])},t.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},t.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},t.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},t}();__reflect(ResJsonUtils.prototype,"ResJsonUtils");var ResUtils=function(){function t(){this.groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceLoadProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.loadGroupQuiet=function(t){var e=this.combGroupName(t);RES.loadGroup(e)},t.prototype.loadGroup=function(t,e,i,o){void 0===o&&(o=1);var n=this.combGroupName(t);this.groups[n]=[e,null,i],RES.loadGroup(n)},t.prototype.loadGroupWithPro=function(t,e,i,o){var n=this.combGroupName(t);this.groups[n]=[e,i,o],RES.loadGroup(n)},t.prototype.combGroupName=function(t){if("string"==typeof t)return t;for(var e=t.length,i="",o=0;e>o;o++)i+=t[o];return RES.createGroup(i,t,!1),i},t.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(console.log("资源组加载完成:"+e),this.groups[e]){var i=this.groups[e][0],o=this.groups[e][2];null!=i&&i.call(o),this.groups[e]=null,delete this.groups[e]}},t.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this.groups[e]){var i=this.groups[e][1],o=this.groups[e][2];null!=i&&i.call(o,t)}},t.prototype.onResourceLoadError=function(t){console.log(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},t}();__reflect(ResUtils.prototype,"ResUtils");